jQuery(function(b){function g(a){a&&a.preventDefault();var a=b(this).closest("tbody").find("tr.bnfund-add-row"),c=b("#_bnfund-template-row").clone(!0);c.find(".bnfund-data-type-edit textarea").val("");h(c,"***",!0);c.find(".bnfund-shortcode-field").html("");c.find(".bnfund-data-sample-view").html("");a.before(c);a=c.find(".bnfund-type-field");a.val("text");b.proxy(i,a)()}function j(a,b,d){var a=a.split("\n"),f="",e=0;if(b==="select"){f+="<select>";for(e=0;e<a.length;e++)f+="<option>"+a[e]+"</option>";f+=
"</select><br/>"}d.html(f)}function k(){var a=b(this).val().toLowerCase(),a=a.replace(/\s/g,"-"),c=b(this).closest("tr"),d=c.find("select.bnfund-type-field");if(d.length){var f=c.find(".bnfund-shortcode-field"),e="";a.length>0&&(e+="[bnfund-"+a,d.val()==="fixed"&&(e+=' value="?"'),e+="]");f.html(e);h(c,a)}}function i(){var a=b(this),c=a.val(),a=a.closest("tr"),d=a.find(".bnfund-data-type-edit"),f=d.find("textarea").first().val(),e=a.find(".bnfund-data-type-sample");switch(c){case "select":f===""?(d.show(),
e.hide()):(d.hide(),j(f,c,e.find(".bnfund-data-sample-view")),e.show());break;default:d.hide(),e.hide()}c=a.find(".bnfund-label-field");b.proxy(k,c)()}function h(a,c,d){var f=a[0].id;a.find('[name^="bnfund_options"]').each(function(){var a=b(this).attr("name"),a=a.replace("["+f+"]","["+c+"]");b(this).attr("name",a);d&&b(this).val("")});a.attr("id",c)}if(typeof bnfund!=="undefined"&&bnfund.validation_rules)b.validationEngineLanguage={allRules:bnfund.validation_rules};b(".bnfund-add-field").click(g);b(".bnfund-delete-field").click(function(a){a.preventDefault();
a=b(this);fieldRowCount=a.closest("tbody").children("tr.bnfund-field-row").length;fieldRowCount==1&&b.proxy(g,this)();a.closest("tr.bnfund-field-row").remove()});b(".bnfund-data-field-edit").click(function(a){a.preventDefault();a=b(this).closest(".bnfund-data-type-sample");a.hide();a.next(".bnfund-data-type-edit").show()});b(".bnfund-data-field-update").click(function(a){a.preventDefault();var a=b(this).closest(".bnfund-data-type-edit"),c=a.find("textarea").first().val(),d=a.prev(".bnfund-data-type-sample"),
f=b(this).closest("tr").find("select.bnfund-type-field").val();a.hide();j(c,f,d.find(".bnfund-data-sample-view"));d.show()});b(".bnfund-move-dn-field").click(function(a){a.preventDefault();a=b(this).closest("tr");a.insertAfter(a.next())});b(".bnfund-move-up-field").click(function(a){a.preventDefault();a=b(this).closest("tr");a.insertBefore(a.prev())});b(".bnfund-type-field").change(i);b(".bnfund-label-field").change(k);b("#bnfund-show-donations").click(function(a){var c=b(this),d=c.data("bnfund-donation-start");
c.data("bnfund-donation-start",d+20);b("#commentsdiv img.waiting").show();d={action:"bnfund_get_donations_list",mode:"single",_ajax_nonce:b("#bnfund_get_donations_nonce").val(),p:b("#post_ID").val(),start:d,number:20};b.post(ajaxurl,d,function(a){a=wpAjax.parseAjaxResponse(a);b("#commentsdiv .widefat").show();b("#commentsdiv img.waiting").hide();"object"==typeof a&&a.responses[0]?(b("#the-comment-list").append(a.responses[0].data),theList=theExtraList=null,b("a[className*=':']").unbind(),c.data("bnfund-donation-start")>
c.data("bnfund-donation-total")?b("#bnfund-show-donations").hide():b("#bnfund-show-donations").html(bnfund.show_more_donations)):1==a?b("#show-donations").parent().html(bnfund.no_more_donations):b("#the-comment-list").append('<tr><td colspan="2">'+wpAjax.broken+"</td></tr>")});a.preventDefault();return!1});b("#bnfund-add-donation").click(function(a){b("#bnfund-add-donation-fields").validationEngine({returnIsValid:!0,promptPosition:"topLeft"})||a.preventDefault()})});
